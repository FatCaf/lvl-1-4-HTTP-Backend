(()=>{"use strict";const e={parent:"#usersTable",columns:[{title:"Ім’я",value:"name"},{title:"Прізвище",value:"surname"},{title:"Аватар",value:"avatar",render:"true"},{title:"Дата Народження",value:"birthday",render:"true"}],apiURL:"https://mock-api.shpp.me/mneklesa/users"};function t(){if(e.hasOwnProperty("columns"))return e.columns}function n(){if(e.hasOwnProperty("apiURL"))return e.apiURL}function r(){[...document.querySelectorAll(".delete__button")].forEach((e=>{e.addEventListener("click",(()=>{!async function(e){await fetch(e,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);o()})).catch((e=>{console.error("Error: ",e.message)}))}(`${n()}/${e.getAttribute("data-id")}`)}))}))}async function o(){const e=document.querySelector(".table__body"),t=document.querySelector(".table__header");e.innerHTML="";let o=n();try{let n=await async function(e,t){try{const e=await fetch(t),n=await e.json();let r={};for(let e in n)r=n[e];return r}catch(e){console.log(e.message)}}(0,o);for(const r in n){e.insertAdjacentHTML("beforeend",`\n        <tr class="table__body__row" id="${r}"></tr>\n        `);const o=document.querySelector(".table__body__row:last-child");for(const e in n[r])if(t.querySelector(`.${e}`).getAttribute("data-render"))if(c(n[r][e])){const t=n[r][e];o.insertAdjacentHTML("beforeend",`\n          <td><image src="${t}"/></td>`)}else{const t=a(n[r][e]);o.insertAdjacentHTML("beforeend",`\n          <td class="date">${t}</td>`)}else o.insertAdjacentHTML("beforeend",`\n          <td>${n[r][e]}</td>`);o.insertAdjacentHTML("beforeend",`<td class="options"><button class="delete__button"\n    data-id="${r}">Delete</button></td>`)}r()}catch(e){console.log(e.message)}}function a(e){const t=new Date(e);return`${t.getDate()<10?`0${t.getDate()}`:t.getDate()}.${t.getMonth()+1<10?`0${t.getMonth()}`:t.getMonth()}.${t.getFullYear()}`}function c(e){return/^(ftp|http|https):\/\/[^ "]+$/.test(e)}function s(){document.querySelector(".table__body").insertAdjacentHTML("afterbegin",'<tr class="new__user">\n  <td><input class="name" type="text" placeholder="Enter name"/></td>\n  <td><input class="surname" type="text" placeholder="Enter surname"/></td>\n  <td><input class="avatar" type="text" placeholder="Enter avatar"/></td>\n  <td><input class="birthday" type="text" placeholder="Enter birth"/></td>\n  <td class="options"><button class="add">Add</button>\n  <button class="cancel">Cancel</button></td>\n  </tr>');document.querySelector(".cancel").addEventListener("click",(()=>{document.querySelector(".new__user").remove()}));document.querySelector(".add").addEventListener("click",l)}async function l(){let e=t();const r=document.querySelector(".new__user");let o={};if(e.forEach((e=>{const t=r.querySelector(`.${e.value}`);t.value.trim()?o[e.value]=t.value:alert(`Please enter a value for ${e.title}`)})),!(Object.keys(o).length<e.length)){const e=JSON.stringify(o);try{const t=await fetch(n(),{method:"POST",headers:{"Content-Type":"application/json"},body:e});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);await renderData()}catch(e){console.error("Error: ",e.message)}}}function d(){const[...e]=document.querySelectorAll(".table__body__row"),t=document.querySelector(".find__user").value;e.forEach((e=>{const n=e.querySelectorAll("td");let r=!1;if(parseInt(t)){document.querySelectorAll(".date").forEach((e=>{const n=e.textContent.trim(),[o,a,c]=n.split(".");o!==t&&a!==t&&c!==t||(i(e),r=!0)}))}else n.forEach((e=>{e.innerHTML.trim().toLowerCase()===t.trim().toLowerCase()&&(r=!0,i(e))}));r&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}))}function i(e){e.classList.add("highlighted"),setTimeout((()=>{e.classList.remove("highlighted")}),3e3)}!function(){let t=function(){if(e.hasOwnProperty("parent"))return e.parent}();const n=document.createElement("table");document.querySelector(t).insertAdjacentElement("afterbegin",n),n.insertAdjacentHTML("afterbegin",'\n        <thead class="table__header">\n        </thead>\n        <tbody class="table__body"></tbody>')}(),function(){const e=document.querySelector(".table__header");let n=t();e.insertAdjacentHTML("beforeend",'<tr class="table__header__row">\n      </tr>');const r=document.querySelector(".table__header__row");for(const e of n)e.hasOwnProperty("render")?r.insertAdjacentHTML("beforeend",`\n              <th class="${e.value}" data-render="true">${e.title}</th>`):r.insertAdjacentHTML("beforeend",`\n              <th class="${e.value}">${e.title}</th>`);r.insertAdjacentHTML("beforeend",'<th class="actions">Дії</th>')}(),o(),document.querySelector(".add__button").addEventListener("click",s),document.querySelector(".find__button").addEventListener("click",d)})();